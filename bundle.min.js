/*
    â’¸ 2024 m00nbyte

    package:  @m00nbyte/pretty-url
    version:  1.0.0
    date:     Sun, 01 Sep 2024 22:53:01 GMT
*/
const e=document.getElementById("url-input"),t=document.getElementById("result"),s=document.getElementById("output"),o=document.getElementById("error"),n=document.querySelectorAll(".output-tab"),r=document.getElementById("formatted-url"),d=document.getElementById("formatted-json"),a=document.getElementById("format-button"),c=document.querySelectorAll(".copy-button");document.getElementById("copy-url"),document.getElementById("copy-json");const l=()=>{t.classList.remove("hidden"),t.classList.add("flex");try{const t=e.value.trim();if(!t.length)throw new Error("Please enter a URL.");const n=new URL(t);if(!["http:","https:"].includes(n.protocol)||!n.hostname||n.pathname.includes(" ")||n.port&&(+n.port<=0||+n.port>65535)||n.search&&n.search.includes(" "))throw new Error("Given URL is not valid.");if(!n.search.length)throw new Error("Given URL has no parameters.");e.classList.remove("border-red-500","focus:border-red-500"),e.classList.add("border-stone-500","focus:border-blue-500");const a=new URLSearchParams(n.search);let c=`${n.origin}${n.pathname}\n\n`;const l={},i=Math.max(...[...a.keys()].map((e=>e.length)),0);for(const[e,t]of a.entries()){c+=`${e.padEnd(i," ")} = ${t}\n`;try{l[e]=JSON.parse(decodeURIComponent(t))}catch{l[e]=t}}r.textContent=c,d.textContent=JSON.stringify({url:t,scheme:n.protocol.replace(":",""),authority:n.hostname,fragment:n.hash.replace("#",""),query:n.search.replace("?",""),host:n.host,path:n.pathname,queryParameters:l},null,4),Prism.highlightElement(d),s.classList.remove("hidden"),s.classList.add("flex"),o.classList.add("hidden")}catch(t){e.classList.remove("border-stone-500","focus:border-blue-500"),e.classList.add("border-red-500","focus:border-red-500"),s.classList.remove("flex"),s.classList.add("hidden"),o.classList.remove("hidden"),o.textContent=t.message}};e.addEventListener("paste",(()=>setTimeout(l,0))),a.addEventListener("click",l),c.forEach((e=>e.addEventListener("click",(async e=>{const t=e.currentTarget,s=t.dataset.type,o=t.querySelector(".copy-icon"),n=t.querySelector(".copy-finish");o.classList.add("hidden");const r=`formatted-${s}`,d=document.getElementById(r)?.textContent;await navigator.clipboard.writeText(d||""),n.classList.remove("hidden"),setTimeout((()=>{o.classList.remove("hidden"),n.classList.add("hidden")}),600)})))),n.forEach((e=>e.addEventListener("click",(e=>{const t=e.currentTarget,s=t.dataset.type;n.forEach((e=>{const o=e.dataset.type;e.dataset.type===s?(document.getElementById(`output-${s}`).classList.remove("hidden"),t.classList.remove("bg-stone-800","hover:bg-stone-700"),t.classList.add("bg-stone-600","hover:bg-stone-600")):(document.getElementById(`output-${o}`).classList.add("hidden"),e.classList.remove("bg-stone-600","hover:bg-stone-600"),e.classList.add("bg-stone-800","hover:bg-stone-700"))}))}))));
